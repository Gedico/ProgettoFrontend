<div class="step-mappa-container">

  <!-- Introduzione Step -->
  <div class="step-intro">
    <div class="step-icon">üó∫Ô∏è</div>
    <h2 class="step-main-title">Conferma la posizione sulla mappa</h2>
    <p class="step-description">
      Assicurati che il marker sia posizionato esattamente dove si trova l'immobile. Puoi trascinarlo per maggiore precisione.
    </p>
  </div>

  <!-- Map Container con overlay -->
  <div class="map-wrapper">
    <div id="map" class="map-container"></div>

    <!-- Overlay istruzioni -->
    <div class="map-overlay">
      <div class="overlay-card">
        <span class="overlay-icon">üëÜ</span>
        <span class="overlay-text">Trascina il marker per regolare la posizione</span>
      </div>
    </div>

    <!-- Info coordinate -->
    <div class="coordinates-info">
      <div class="coordinate-item">
        <span class="coordinate-label">Latitudine:</span>
        <span class="coordinate-value">
          {{ posizioneForm.get('latitudine')?.value | number:'1.6-6' }}
        </span>
      </div>
      <div class="coordinate-divider">‚Ä¢</div>
      <div class="coordinate-item">
        <span class="coordinate-label">Longitudine:</span>
        <span class="coordinate-value">
          {{ posizioneForm.get('longitudine')?.value | number:'1.6-6' }}
        </span>
      </div>
    </div>
  </div>

  <!-- Indirizzo corrente -->
  @if (posizioneForm.get('indirizzo')?.value) {
    <div class="current-address">
      <div class="address-icon">üìç</div>
      <div class="address-content">
        <div class="address-label">Indirizzo selezionato:</div>
        <div class="address-text">{{ posizioneForm.get('indirizzo')?.value }}</div>
      </div>
    </div>
  }

  <!-- Info box suggerimenti -->
  <div class="info-box">
    <div class="info-icon">üí°</div>
    <div class="info-content">
      <strong>Suggerimenti:</strong>
      <ul>
        <li>Posiziona il marker con precisione per aiutare gli acquirenti a trovare l'immobile</li>
        <li>Puoi usare lo zoom per vedere meglio la zona</li>
        <li>Il marker pu√≤ essere trascinato anche dopo averlo posizionato</li>
      </ul>
    </div>
  </div>

  <!-- Validazione visiva -->
  <div class="validation-status">
    @if (posizioneForm.get('latitudine')?.value && posizioneForm.get('longitudine')?.value) {
      <div class="status-valid">
        <span class="status-icon">‚úì</span>
        <span class="status-text">Posizione confermata</span>
      </div>
    } @else {
      <div class="status-invalid">
        <span class="status-icon">‚ö†Ô∏è</span>
        <span class="status-text">Posiziona il marker sulla mappa</span>
      </div>
    }
  </div>

  <!-- Bottoni Navigazione -->
  <div class="button-group">
    <button
      type="button"
      class="btn btn-secondary"
      (click)="indietro.emit()">
      ‚Üê Indietro
    </button>

    <button
      type="button"
      class="btn btn-primary"
      (click)="avanti.emit()"
      [disabled]="!posizioneForm.get('latitudine')?.value || !posizioneForm.get('longitudine')?.value">
      @if (posizioneForm.get('latitudine')?.value && posizioneForm.get('longitudine')?.value) {
        Continua ‚Üí
      } @else {
        Posiziona il marker
      }
    </button>
  </div>

</div>
