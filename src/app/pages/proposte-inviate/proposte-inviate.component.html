<h2 class="titolo">Le mie proposte</h2>

<!-- ===================== CARICAMENTO ===================== -->
@if (caricamento) {
  <div class="caricamento">Caricamento in corso...</div>
}

<!-- ===================== NESSUNA PROPOSTA ===================== -->
@if (!caricamento && proposte.length === 0) {
  <div class="vuoto">
    <p>Non hai ancora inviato alcuna proposta.</p>
  </div>
}

<!-- ===================== PROPOSTE ATTIVE ===================== -->
@if (!caricamento && (controproposteAttive.length > 0 || proposteAttive.length > 0)) {
  <h3 class="sottotitolo">Proposte attive</h3>

  <!-- üî∏ CONTROPROPOSTE DA GESTIRE -->
  @for (p of controproposteAttive; track p.idProposta) {
    <div class="card controproposta">

      <div class="card-header">
        <h4>{{ p.titoloInserzione }}</h4>
        <span class="badge badge-controproposta">
          {{ labelStato(p.stato) }}
        </span>
      </div>

      <div class="info">
        <p>
          <strong>Importo proposto:</strong>
          {{ p.importo | currency:'EUR':'symbol':'1.0-0' }}
        </p>

        <p>
          <strong>Data:</strong>
          {{ p.dataCreazione | date:'dd/MM/yyyy HH:mm' }}
        </p>

        <div class="azioni">
          <button type="button" class="btn-accetta" (click)="accetta(p)">
            ‚úî Accetta
          </button>

          <button type="button" class="btn-rifiuta" (click)="rifiuta(p)">
            ‚úñ Rifiuta
          </button>

          <button
            type="button"
            class="btn-dettagli"
            [routerLink]="['/inserzione', p.idInserzione]">
            üëÅ Vedi inserzione
          </button>
        </div>
      </div>
    </div>
  }

  <!-- üî∏ PROPOSTE IN ATTESA -->
  @for (p of proposteAttive; track p.idProposta) {
    <div class="card attiva">

      <div class="card-header">
        <h4>{{ p.titoloInserzione }}</h4>
        <span class="badge badge-attesa">In attesa</span>
      </div>

      <div class="info">
        <p>
          <strong>Tua offerta:</strong>
          {{ p.importo | currency:'EUR':'symbol':'1.0-0' }}
        </p>

        <p>
          <strong>Data invio:</strong>
          {{ p.dataCreazione | date:'dd/MM/yyyy HH:mm' }}
        </p>

        <button
          type="button"
          class="btn-dettagli"
          [routerLink]="['/inserzione', p.idInserzione]">
          üëÅ Vedi inserzione
        </button>
      </div>
    </div>
  }
}

<!-- ===================== PROPOSTE ACCETTATE ===================== -->
@if (!caricamento && proposteAccettate.length > 0) {
  <h3 class="sottotitolo success">Proposte accettate</h3>

  @for (p of proposteAccettate; track p.idProposta) {
    <div class="card accettata">

      <div class="card-header">
        <h4>{{ p.titoloInserzione }}</h4>
        <span class="badge badge-accettata">
          {{ labelStato(p.stato) }}
        </span>
      </div>

      <div class="info">
        <p>
          <strong>Tua offerta:</strong>
          {{ p.importo | currency:'EUR':'symbol':'1.0-0' }}
        </p>

        <p>
          <strong>Data invio:</strong>
          {{ p.dataCreazione | date:'dd/MM/yyyy HH:mm' }}
        </p>

        <button
          type="button"
          class="btn-dettagli"
          [routerLink]="['/inserzione', p.idInserzione]">
          üëÅ Vedi inserzione
        </button>
      </div>
    </div>
  }
}

<!-- ===================== PROPOSTE RIFIUTATE ===================== -->
@if (!caricamento && proposteRifiutate.length > 0) {
  <h3 class="sottotitolo muted">Proposte rifiutate</h3>

  @for (p of proposteRifiutate; track p.idProposta) {
    <div class="card rifiutata">

      <div class="card-header">
        <h4>{{ p.titoloInserzione }}</h4>
        <span class="badge badge-rifiutata">
          {{ labelStato(p.stato) }}
        </span>
      </div>

      <div class="info">
        <p>
          <strong>Tua offerta:</strong>
          {{ p.importo | currency:'EUR':'symbol':'1.0-0' }}
        </p>

        <p>
          <strong>Data invio:</strong>
          {{ p.dataCreazione | date:'dd/MM/yyyy HH:mm' }}
        </p>

        <button
          type="button"
          class="btn-dettagli"
          [routerLink]="['/inserzione', p.idInserzione]">
          üëÅ Vedi inserzione
        </button>
      </div>
    </div>
  }
}
