<!-- CARICAMENTO -->
<div *ngIf="caricamento" class="loading">Caricamento inserzione...</div>

<!-- CONTENUTO -->
<div *ngIf="!caricamento && inserzione" class="container-inserzione">

  <!-- TITOLO & PREZZO -->
  <div class="header" *ngIf="inserzione?.dati">
    <h1>{{ inserzione.dati.titolo }}</h1>

    <h2>{{ inserzione.dati.prezzo | currency:'EUR':'symbol' }}</h2>
  </div>

  <!-- Bottone Offerta -->
  <button class="proposta-btn" (click)="toggleFormOfferta()">
    ðŸ’¶ Fai un'offerta
  </button>

  <!-- ===================== MODAL ======================= -->
  <div class="overlay" *ngIf="mostraFormOfferta" (click)="toggleFormOfferta()"></div>

  <div class="modal-card" *ngIf="mostraFormOfferta">
    <h2>Invia una proposta</h2>

    <form [formGroup]="offertaForm" (ngSubmit)="inviaProposta()">

      <label>Importo offerta (â‚¬)</label>
      <input type="number" formControlName="prezzoProposta" class="input-field"/>

      <div class="validation" *ngIf="prezzoProposta?.touched && prezzoProposta?.invalid">
        Minimo accettato:
        <strong>{{ prezzoMinimo | currency:'EUR':'symbol':'1.0-0' }}</strong>
      </div>

      <label>Note (opzionale)</label>
      <textarea formControlName="note" class="textarea-field"></textarea>

      <button class="submit-btn" type="submit">Invia proposta</button>
      <button class="close-btn" type="button" (click)="toggleFormOfferta()">Chiudi</button>

    </form>
  </div>
  <!-- ===================== FINE MODAL ======================= -->

  <!-- FOTO PRINCIPALE -->
  <div class="galleria">
    <img class="foto-principale"
         *ngIf="inserzione && inserzione.foto?.length"

         [src]="inserzione.foto[0].url"
         alt="Foto principale"/>
  </div>

  <!-- DETTAGLI -->
  <div class="dettagli" *ngIf="inserzione?.dati">
    <h3>Dettagli</h3>

    <p><strong>Superficie:</strong> {{ inserzione.dati.dimensioni }} mÂ²</p>
    <p><strong>Stanze:</strong> {{ inserzione.dati.numeroStanze }}</p>
    <p><strong>Piano:</strong> {{ inserzione.dati.piano }}</p>
    <p><strong>Ascensore:</strong> {{ inserzione.dati.ascensore ? 'SÃ¬' : 'No' }}</p>
    <p><strong>Classe energetica:</strong> {{ inserzione.dati.classeEnergetica }}</p>
  </div>

  <!-- DESCRIZIONE -->
  <div class="descrizione" *ngIf="inserzione?.dati">
    <h3>Descrizione</h3>
    <p>{{ inserzione.dati.descrizione }}</p>
  </div>

  <!-- POSIZIONE -->
  <div class="posizione" *ngIf="inserzione?.posizione">
    <h3>Posizione</h3>
    <p>{{ inserzione.posizione.descrizione }}</p>

    <iframe width="100%" height="300" [src]="mappaUrl"></iframe>
  </div>

</div>

